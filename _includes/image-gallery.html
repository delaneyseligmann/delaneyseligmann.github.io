{% assign media_paths = include.images | split: "," %}
{% assign gallery_height = include.height | default: "300" %}

<div class="image-gallery" style="--gallery-height: {{ gallery_height }}px;">
  {% for media_path in media_paths %}
    {% assign media_name = media_path | strip %}
    {% assign page_url_without_index = page.url | remove: 'index' | remove: '.html' %}

    {% if media_name contains '.mp4' %}
      <video
        controls
        playsinline
        style="max-height: {{ gallery_height }}px; width: 100%;"
      >
        <source src="{{ page_url_without_index }}{{ media_name }}" type="video/mp4">
      </video>

    {% elsif media_name contains 'https://' %}
      <img
        src="{{ media_name }}"
        alt="Web image"
        loading="lazy"
      />

    {% else %}
      <img
        src="{{ page_url_without_index }}{{ media_name }}"
        alt="{{ media_name }}"
        loading="lazy"
        onerror="this.onerror=null;this.src=this.src.replace('.webp','.png').replace('.png','.webp');"
      />
    {% endif %}
  {% endfor %}
</div>
